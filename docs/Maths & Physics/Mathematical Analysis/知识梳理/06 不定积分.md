### 不定积分

**定义：不定积分**

设函数 $f$ 在区间 $I$ 上有定义，函数 $F$ 是 $f$ 的一个原函数，则函数族

$$
F(x) + C \quad (C \in \mathbb{R})
$$

表示 $f$ 的一切原函数. 我们把这函数族叫作函数 $f(x)$ 的不定积分，或者叫作微分形式 $f(x)dx$ 的不定积分，记为

$$
\int f(x)dx = F(x) + C.
$$

在这里，$f(x)$ 称为**被积函数**，$f(x)dx$ 称为**被积表示式**，而 $\int$ 是表示不定积分的符号。


**定理：不定积分的线性运算法则**

如果 $F(x)$ 和 $G(x)$ 分别是函数 $f(x)$ 和 $g(x)$ 的原函数，$\lambda$ 是一个非零实数，那么 $F(x) + G(x)$ 是函数 $f(x) + g(x)$ 的原函数，$\lambda F(x)$ 是函数 $\lambda f(x)$ 的原函数。即有以下运算法则：

$$
\int (f(x) + g(x))dx = \int f(x)dx + \int g(x)dx;
$$

$$
\int (\lambda f(x))dx = \lambda \int f(x)dx.
$$

##### 换元积分法

- 依据：微分表示的不变性.

**引理**
如果 $dG(u) = g(u)du,$ 那么把 $u$ 换成可微函数 $u = u(v)$ 仍有 $dG(u(v)) = g(u(v))du(v).$
这就是说，从

$$
\int g(u)du = G(u) + C
$$

可以得到

$$
\int g(u(v))du(v) = G(u(v)) + C.
$$

上面的引理说明：在不定积分的表示式中可以做变数替换. 这一结果以两种形式应用于求不定积分.

**第一换元积分法**

把被积表示式 $f(x)dx$ 写成两因式的乘积，前一因式形状如 $g(u(x))$，后一因式形状如 $du(x)$。如果求得

$$
\int g(u)du = G(u) + C,
$$

那么

$$
\int f(x)dx = \int g(u(x))du(x) = G(u(x)) + C.
$$

在具体解题的时候，不必每次写出代表中间变量的符号 $u$，只要把 $u(x)$ 当作一个整体来看待即可.

**第二换元积分法**
做适当的变数替换 $x = \varphi(t)$，这里的函数 $\varphi(t)$ 在区间 $J$ 上**严格单调并且连续**，**在这区间的内部可导**，并且满足条件 $\varphi'(t) \neq 0$。如果我们求得

$$
\int f(\varphi(t)) \, d\varphi(t) = G(t) + C,
$$

那么在这式中做变数替换 $t = \varphi^{-1}(x)$ 就得到

$$
\int f(x) \, dx = G(\varphi^{-1}(x)) + C.
$$

**注：**
对于涉及 $\sqrt{a^2 - x^2}$ 或 $\sqrt{x^2 + a^2}$ 的被积函数，可以引入一个辅助的“角变量”$t$ 作为参数.

1. 对于涉及 $\sqrt{a^2 - x^2}$ 的被积函数，可以令 $x = a \cos t$ 或者 $x = a \sin t$.
2. 对于涉及 $\sqrt{x^2 + a^2}$ 的被积函数，可以令 $x = a \tan t$ 或者 $x = a \cot t$.
3. 对于涉及 $\sqrt{x^2 - a^2}$ 的被积函数，可以令 $x = a \sec t = \dfrac{a}{\cos t}$ 或者 $x = a \csc t = \dfrac{a}{\sin t}$.

##### 分部积分法

- 依据：乘积微分公式 $d(u(x)v(x)) = v(x)du(x) + u(x)dv(x).$

把该公式改写为

$$
u(x)dv(x) = d(u(x)v(x)) - v(x)du(x),
$$

由此得到

$$
\int u(x)dv(x) = u(x)v(x) - \int v(x)du(x).
$$

即分部积分法的公式. 应用时，不必引入新的记号 $u$ 和 $v$，只需记住把哪个式子当作 $u(x)$，哪个式子当作 $v(x)$.


##### 有理函数的积分

- 以下讨论几类可积分为有限形式的函数

对有理分式函数 $f(x) = P(x)/Q(x)$，这里 $P(x)$ 和 $Q(x)$ 都是实系数的多项式.利用多项式的带余除法，总可以把有理分式写成以下形式

$$
P(x)/Q(x) = P_0(x)+P_1(x)/Q(x),
$$

其中 $P_0(x)$ 和 $Q(x)$ 也是实系数的多项式，其中 $P_1(x)$ 的次数低于 $Q(x)$ 的次数. 多项式的不定积分已知，因此只需要讨论真分式 $P_1(x)/Q(x)$ 的不定积分. 以下设 $f(x) = P(x)/Q(x)$ 是既约真分式.

**定理**
如上所述的真分式 $\frac{P(x)}{Q(x)}$，可以唯一地表示为以下形状的简单分式之和：

$$
\begin{aligned}
&\sum_{i=1}^{r} \left( \frac{A_i}{x-a_i} + \frac{A_i'}{(x-a_i)^2} + \cdots + \frac{A_i^{(h_i-1)}}{(x-a_i)^{h_i}} \right) \\
&+ \sum_{j=1}^{s} \Bigg( \frac{M_j x + N_j}{x^2 + p_j x + q_j} + \frac{M_j' x + N_j'}{(x^2 + p_j x + q_j)^2} \\
&\qquad + \cdots + \frac{M_j^{(k_j-1)} x + N_j^{(k_j-1)}}{(x^2 + p_j x + q_j)^{k_j}} \Bigg),
\end{aligned}
$$

这里的 $A_i, A_i', \cdots, A_i^{(h_i-1)}, M_j, M_j', \cdots, M_j^{(k_j-1)}, N_j, N_j', \cdots, N_j^{(k_j-1)}$ 等都是实常数 $(i=1, \cdots, r, j=1, \cdots, s)$.

定理1中的分解式，通常就叫作真分式 $\frac{P(x)}{Q(x)}$ 的**简单分式分解**或者**部分分式分解**.

**待定系数法求真分式的部分分式分解.**

1. 先写出含有待定系数 $A_i, \cdots, A_i^{(h_i-1)}, M_j, \cdots, M_j^{(k_j-1)}, N_j, \cdots, N_j^{(k_j-1)}$ 的分解式

$$
\frac{P(x)}{Q(x)} = \sum_{i=1}^r \left( \frac{A_i}{x-a_i} + \cdots + \frac{A_i^{(h_i-1)}}{(x-a_i)^{h_i}} \right)
+ \sum_{j=1}^s \left( \frac{M_j x + N_j}{x^2 + p_j x + q_j} + \cdots + \frac{M_j^{(k_j-1)} x + N_j^{(k_j-1)}}{(x^2 + p_j x + q_j)^{k_j}} \right);
$$

2. 用 $Q(x)$ 乘上述两边以消去分母；
3. 比较所得式子两边同次项的系数，得到关于待定系数的线性方程组；
4. 解这个方程组就可确定部分分式分解的各个系数。

通过部分分式分解，求有理分式的不定积分的问题归结为计算以下两种类型积分：

$$
\mathrm{I}.\quad \int \frac{dx}{(x-a)^n};
$$

$$
\mathrm{II}.\quad \int \frac{Mx+N}{(x^2+px+q)^n} dx.
$$

对 $\mathrm{I}$ 型积分已有：

$$
\int \frac{dx}{(x-a)^n} = 
\begin{cases} 
\displaystyle \frac{-1}{(n-1)(x-a)^{n-1}} + C, & n \neq 1, \\
\ln |x-a| + C, & n=1.
\end{cases}
$$

为计算 $\mathrm{II}$ 型积分，将 $x^2+px+q$ 写成

$$
x^2+px+q=(x+p/2)^2+q-p^2/4 = t^2+b^2,
$$

这里 $t = x + p/2$, $b = \sqrt{q - p^2/4}$。通过变数替换 $x = t - p/2$，求Ⅱ型积分的问题又归结为计算以下两种类型的不定积分：

$$
\mathrm{II'}.\ \int \frac{t}{(t^2 + b^2)^n} dt;
$$

$$
\mathrm{II''}.\ \int \frac{dt}{(t^2 + b^2)^n}.
$$

其中 $\mathrm{II'}$ 型积分很容易计算：

$$
\int \frac{t dt}{(t^2 + b^2)^n} = 
\begin{cases}
\displaystyle \frac{-1}{2(n-1)(t^2 + b^2)^{n-1}} + C, & n \neq 1, \\
\displaystyle \frac{1}{2}\ln(t^2 + b^2) + C, & n = 1.
\end{cases}
$$

为了计算 $\mathrm{II''}$ 型积分 $J_n$，可以利用已知的递推公式

$$
J_n = \frac{1}{2(n-1)b^2} \cdot \frac{t}{(t^2 + b^2)^{n-1}} + \frac{2n-3}{2(n-1)b^2} J_{n-1}
$$

和已知的结果

$$
J_1 = \frac{1}{b} \arctan \frac{t}{b} + C.
$$

这样，我们完全解决了求有理分式函数的不定积分的问题.


##### 某些可有理化的被积表示式

**三角函数有理式的不定积分**
$R(\sin x, \cos x) dx$

被积表示式 $R(\sin x, \cos x) dx$ 可以通过变元替换

$$
\tan \frac{x}{2} = t, \quad \text{即} \quad x = 2 \arctan t
$$

实现有理化。事实上，有

$$
\sin x = 2 \tan \frac{x}{2} \cos^2 \frac{x}{2} = \frac{2t}{1 + t^2},
$$

$$
\cos x = \cos^2 \frac{x}{2} \left( 1 - \tan^2 \frac{x}{2} \right) = \frac{1 - t^2}{1 + t^2},
$$

$$
dx = \frac{2dt}{1 + t^2}.
$$

于是得到

$$
R(\sin x, \cos x)dx = R\left( \frac{2t}{1+t^2}, \frac{1-t^2}{1+t^2} \right) \frac{2dt}{1+t^2}.
$$

对于某些特别情形，采用其他形式的变换更为简单。例如，对于形状如

$$
R_1(\sin x, \cos^2 x) \cos x dx
$$

的表示式，采用替换 $\sin x = t$ 就可以更方便地把它有理化为

$$
R_1(t, 1 - t^2) dt.
$$

对于形状如

$$
R_2(\sin^2 x, \cos x) \sin x dx
$$

的表示式，采用替换 $\cos x = t$ 也就可以把它有理化为

$$
-R_2(1 - t^2, t) dt.
$$

另外，对于形状如

$$
R_3\left( \frac{\sin x}{\cos x}, \cos^2 x \right) dx
$$

的表示式，可采用替换 $\tan x = t, \quad \text{即} \quad x = \arctan t$ 将它有理化为

$$
R_3\left( t, \frac{1}{1+t^2} \right) \frac{dt}{1+t^2}.
$$


**某些无理根式的不定积分**

$R\left(x, \sqrt[n]{\frac{ax + \beta}{\gamma x + \delta}}\right) dx$

如果 $a\delta - \beta\gamma = 0$，可设

$$
\frac{a}{\gamma} = \frac{\beta}{\delta} = \lambda,
$$

那么

$$
R\left(x, \sqrt[n]{\frac{ax + \beta}{\gamma x + \delta}}\right) dx = R\left(x, \sqrt[n]{\lambda}\right) dx,
$$

它本身已是有理式。因此，在以下的讨论中，不妨设

$$
a\delta - \beta\gamma \neq 0.
$$

在被积表示式中做替换

$$
t = \sqrt[n]{\frac{ax + \beta}{\gamma x + \delta}}, \quad \text{即} \quad x = \frac{\delta t^n - \beta}{a - \gamma t^n},
$$

得到

$$
dx = \frac{n(a\delta - \beta\gamma)t^{n-1}}{(a - \gamma t^n)^2} dt.
$$

于是 $R\left(x, \sqrt[n]{\frac{ax + \beta}{\gamma x + \delta}}\right) dx$ 有理化为

$$
R\left( \frac{\delta t^n - \beta}{a - \gamma t^n}, t \right) \frac{n(a\delta - \beta\gamma)t^{n-1}}{(a - \gamma t^n)^2} dt.
$$

本段的讨论也适用于 $\gamma = 0$ 的情形（这时不妨设 $\delta = 1$）. 对于

$$
R\left(x, \sqrt[n]{ax + \beta}\right) dx,
$$

可以作替换 $t = \sqrt[n]{ax + \beta}$ 使它有理化。




$R(x, \sqrt{ax^2 + bx + c}) dx$

1. 常规方法：

$$
ax^2 + bx + c = a \left( x + \frac{b}{2a} \right)^2 + c - \frac{b^2}{4a}
= \pm \left[ \sqrt{a} \left( x + \frac{b}{2a} \right) \right]^2 \pm \left( \sqrt{c - \frac{b^2}{4a}} \right)^2.
$$

通过适当的线性替换 $u = \sqrt{a} \left( x + \frac{b}{2a} \right)$ 和记 $\lambda = \sqrt{\left| c - \frac{b^2}{4a} \right|}$，可以将 $\sqrt{ax^2+bx+c}$ 化成以下三种情形之一：

$$
\sqrt{u^2+\lambda^2}, \quad \sqrt{u^2-\lambda^2} \quad \text{或} \quad \sqrt{\lambda^2-u^2}
$$

（被开方式恒负的情形可不予考虑）。这样，$R(x, \sqrt{ax^2+bx+c})dx$ 转化为：

$$
R_1(u, \sqrt{u^2+\lambda^2})du, \quad R_2(u, \sqrt{u^2-\lambda^2})du \quad \text{或} \quad R_3(u, \sqrt{\lambda^2-u^2})du.
$$

对这三种情形，分别令

$$
u=\lambda \tan t, \quad u=\lambda \sec t \quad \text{或} \quad u=\lambda \sin t,
$$

就可以将被积表示式转化为三角函数的有理式。再套用三角函数有理式的不定积分就可以最后完成有理化的进程。

2. 欧拉变换
一般地，二次三项式 $ax^2+bx+c$ 中，若 $a>0$，则可令

$$
\sqrt{ax^2+bx+c} = \sqrt ax \pm t;
$$

若 $c>0$，还可令

$$
\sqrt{ax^2+bx+c} = xt\pm\sqrt c.
$$

这类变换称为欧拉变换.