### 柯西中值定理和不定式极限

##### 柯西中值定理

>由拉格朗日中值定理，在显式表示的可微曲线段上，至少存在一点，该点切线平行于联结该曲线段两端的弦. 将该结论推广到参数表示的可微曲线段上，即为柯西中值定理.

**定理：柯西中值定理**
设函数 $f(x)$ 和 $g(x)$ 在 $[a,b]$ 上连续，在 $(a,b)$ 上可导，并且满足条件 $f'(x)$ 和 $g'(x)$ 不同时为零；$g(a) \neq g(b)$，则存在 $\xi \in (a,b)$ 使得

$$
\frac{f(b) - f(a)}{g(b) - g(a)} = \frac{f'(\xi)}{g'(\xi)}.
$$


##### 不定式（未定式）

若

$$
\lim_{x \to a} f(x) = A, \quad \lim_{x \to a} g(x) = B, \quad a, A, B \in \mathbb{R}\cup\infty,
$$

有

1. $\lim\limits_{x \to a} (f(x) + g(x)) = A + B;$
2. $\lim\limits_{x \to a} (f(x) - g(x)) = A - B;$
3. $\lim\limits_{x \to a} (f(x)g(x)) = AB;$
4. $\lim\limits_{x \to a} \frac{f(x)}{g(x)} = \frac{A}{B};$
5. $\lim\limits_{x \to a} (f(x))^{g(x)} = \lim\limits_{x \to a} e^{g(x)\ln f(x)} = e^{B\ln A} = A^B.$

对于以上各条，所说的例外情形分别是：

1. 在 1 中 $A$ 与 $B$ 为异号无穷大；
2. 在 2 中 $A$ 与 $B$ 为同号无穷大；
3. 在 3 中 $A$ 与 $B$ 之一为 0，另一为无穷大；
4. 在 4 中 $A$ 与 $B$ 同时为 0 或者 $A$ 与 $B$ 同时为无穷大；
5. 在 5 中 $A = 1, B = \infty$，或者 $A = 0, B = 0$，或者 $A = \infty, B = 0.$

这些例外情形所涉及的极限类型统称为未定型. 

未定型的极限式被称为**未定式（不定式）**，运算法则 1~5 对不定式失去效用.
在一定的条件下，**洛必达法则**提供了确定未定型极限的有效办法，称为未定式的定值法.


##### 洛必达法则（求 $\frac{0}{0}$ 型和 $\frac{\infty}{\infty}$ 型不定式定值法）

**定理：求 $\frac{0}{0}$ 型不定式极限**

设 $a \in \mathbb{R}$ 或 $a = \infty$，$l \in \mathbb{R}$ 或 $l = \infty$。如果函数 $f$ 和 $g$ 在 $a$ 点的去心邻域 $U^{\circ}(a)$ 上可导，$g'(x) \neq 0$，$\forall x \in U^{\circ}(a)$，并且满足：

1. $\lim\limits_{x \to a} f(x) = \lim\limits_{x \to a} g(x) = 0$；
2. $\lim\limits_{x \to a} \frac{f'(x)}{g'(x)} = l$，

则有

$$
\lim_{x \to a} \frac{f(x)}{g(x)} = l.
$$



**定理：求 $\frac{*}{\infty}$ 型不定式极限**

设 $a \in \mathbb{R}$ 或 $a = \infty$，$l \in \mathbb{R}$ 或 $l = \infty$。如果函数 $f$ 和 $g$ 在 $a$ 点的去心邻域 $U^{\circ}(a)$ 上可导，$g'(x) \neq 0$，$\forall x \in U^{\circ}(a)$，并且满足：

1. $\lim\limits_{x \to a} g(x) = \infty$；
2. $\lim\limits_{x \to a} \frac{f'(x)}{g'(x)} = l$，

则有

$$
\lim_{x \to a} \frac{f(x)}{g(x)} = l.
$$

**注：**

1. 为了求某些不定式的极限，有时需要接连几次运用洛必达法则.
2. 如果导数的比值有极限，那么原函数的比值也有相同的极限. 但是，**如果导数的比值没有极限，并不代表原极限不存在！** 此时说明洛必达法则**失效**，需改用夹逼定理或定义法.
3. 洛必达法则通常不单独使用，而是和**等价无穷小代换**、**泰勒公式**结合使用.
4. 求数列极限也可先利用洛必达法则求对应**函数**的极限，再利用归结原则得到数列极限.


##### 其它类型不定式的定值法

>其它类型的不定式，一般都能转化为 $\frac{0}{0}$ 型未定式或 $\frac{\infty}{\infty}$ 型未定式，因而在一定的条件下也能利用洛必达法则来定值.

**$0 \cdot \infty$ 型不定式**
设 $\lim\limits_{x \to a} f(x) = 0$，$\lim\limits_{x \to a} g(x) = \infty$，则极限式 $\lim\limits_{x \to a} f(x)g(x)$ 是 $0 \cdot \infty$ 型未定式. 我们可以把它写成

$$
\lim_{x \to a} f(x)g(x) = \lim_{x \to a} \frac{f(x)}{\frac{1}{g(x)}},
$$

这就化成了 $\frac{0}{0}$ 型未定式.


**$\infty - \infty$ 型未定式**
设 $\lim\limits_{x \to a} f(x)$ 与 $\lim\limits_{x \to a} g(x)$ 是同号的无穷大，则极限式 $\lim\limits_{x \to a} (f(x) - g(x))$ 是 $\infty - \infty$ 型未定式。我们可以把它写成

$$
\lim_{x \to a} \left( \frac{1}{\frac{1}{f(x)}} - \frac{1}{\frac{1}{g(x)}} \right) = \lim_{x \to a} \frac{\frac{1}{g(x)} - \frac{1}{f(x)}}{\frac{1}{f(x)g(x)}},
$$

这也化成了 $\frac{0}{0}$ 型未定式.


**$1^\infty$，$0^0$ 和 $\infty^0$ 型未定式**
设 $\lim\limits_{x \to a} f(x) = 1$，$\lim\limits_{x \to a} g(x) = \infty$，则极限式 $\lim\limits_{x \to a} [f(x)]^{g(x)}$ 是 $1^\infty$ 型未定式。我们可以把它写成

$$
\lim_{x \to a} e^{g(x) \ln f(x)} = e^{\lim\limits_{x \to a} g(x) \ln f(x)}
$$

于是，问题归结为求 $0 \cdot \infty$ 型未定式的极限：

$$
\lim_{x \to a} g(x) \ln f(x).
$$

对于 $0^0$ 和 $\infty^0$ 型未定式，也可做类似的讨论.

*注：为了把其他形式的未定式转化成 $\frac{0}{0}$ 或 $\frac{\infty}{\infty}$ 型未定式，需要根据实际情况灵活地进行变换。如果死套上面所说的一般程序，有时会十分烦琐.*


### 泰勒公式

##### 带 $o$ 余项的泰勒公式
>带 $o$ 余项的泰勒公式是无穷小增量公式的推广. 泰勒多项式部分模拟函数在某一点处的情况，$o$ 余项用来表示误差的等级.

**引理** 设函数 $f(x)$ 和 $g(x)$ 在 $U(a, \eta)$ 有定义，在 $a$ 点有 $n$ 阶导数. 如果

$$
f^{(k)}(a) = g^{(k)}(a), \quad k = 0, 1, \cdots, n,
$$

那么

$$
f(x) = g(x) + o((x - a)^n).
$$



**定理：带 $o$ 余项的泰勒公式
**
设函数 $f$ 在 $U(a, \eta)$ 有定义，在 $a$ 点有 $n$ 阶导数，那么

$$
f(x) = f(a) + f'(a)(x - a) + \frac{f''(a)}{2!}(x - a)^2 + \cdots + \frac{f^{(n)}(a)}{n!}(x - a)^n + o((x - a)^n).
$$

这定理中的表示式称为带小 $o$ 余项的泰勒公式，又称**带皮亚诺（Peano）余项的泰勒公式**. 特别地，当 $a = 0$ 时，我们称相应的表示式为带小 $o$ 余项的麦克劳林（Maclaurin）公式或者带皮亚诺余项的麦克劳林公式，简称**麦克劳林公式**.


**定理：由导函数的麦克劳林公式确定原函数的麦克劳林公式**

设函数 $f(x)$ 在 $U(0, \eta)$ 有定义，在0点$n$次可导，如果

$$
f'(x) = A_0' + A_1' x + \cdots + A_{n-1}' x^{n-1} + o(x^{n-1})
$$

$$
(A_0', A_1', \cdots, A_{n-1}' \in \mathbb{R}),
$$

那么

$$
f(x) = f(0) + A_0' x + \frac{A_1'}{2} x^2 + \cdots + \frac{A_{n-1}'}{n} x^n + o(x^n).
$$


###### 极值的第三充分条件
[[05 导数和微分#函数的升降与极值 | 极值的第一和第二充分条件]]

**引理**  设 $A \neq 0$,并且

$$
\varphi(h) = Ah^n + o(h^n),
$$

则对充分小的 $h$, $\varphi(h)$ 与 $Ah^n$ 同号.


**定理：极值的第三充分条件** 

设函数 $f$ 在 $U(x_0, \eta)$ 有定义，在 $x_0$ 点 $n$ 次可导,并且

$$
f'(x_0) = \cdots = f^{(n-1)}(x_0) = 0, \quad f^{(n)}(x_0) \neq 0,
$$

则有

1. 如果 $n$ 是偶数,那么函数 $f$ 在 $x_0$ 点取得严格极值——当 $f^{(n)}(x_0) > 0$ 时 $f$ 在 $x_0$ 点取得严格极小值,当 $f^{(n)}(x_0) < 0$ 时 $f$ 在 $x_0$ 点取得严格极大值;
2. 如果 $n$ 是奇数,那么 $x_0$ 不是函数 $f$ 的极值点.


##### 有限增量的泰勒公式
>带 $o$ 余项的泰勒公式只适宜于讨论当 $x$ 趋近于 $a$ 时函数的渐近状况，为研究函数在较大范围内的性质，需要引入有限增量的泰勒公式.

###### 带拉格朗日余项的泰勒公式

**引理** 设函数 $\varphi(x)$ 在区间 $I$ 有直到 $n$ 阶的连续导数，在 $I^0$ 有 $n+1$ 阶导数，$a, x \in I$. 如果

$$
\varphi(a) = \varphi'(a) = \cdots = \varphi^{(n)}(a) = 0,
$$

那么存在介于 $a$ 和 $x$ 之间的实数 $\xi$，使得

$$
\varphi(x) = \frac{\varphi^{(n+1)}(\xi) \cdot (x - a)^{n+1}}{(n + 1)!}.
$$

*注：对照 $o$ 余项的引理，从讨论某点到讨论某区间.*
*（证明使用柯西中值定理+洛必达法则）.*


**定理：带拉格朗日余项的泰勒公式**

设函数 $f$ 在区间 $I$ 上有直到 $n$ 阶的连续导数，在 $I^0$ 有 $n+1$ 阶导数，$a, x \in I$，则

$$
f(x) = f(a) + \frac{f'(a)}{1!} (x-a) + \frac{f''(a)}{2!} (x-a)^2 + \cdots + \frac{f^{(n)}(a)}{n!} (x-a)^n + \frac{f^{(n+1)}(\xi)}{(n+1)!} (x-a)^{n+1}.
$$

换句话说就是：泰勒公式的余项 $R_n(x)$ 可以表示成

$$
R_n(x) = \frac{f^{(n+1)}(\xi)}{(n+1)!} (x-a)^{n+1},
$$

上式称为拉格朗日型余项.

**注：**
与拉格朗日中值定理那里的讨论类似，如果令 $\theta = \frac{\xi - a}{x - a}$ 那么 $\xi = a + \theta (x - a), \quad 0 < \theta < 1.$ 于是拉格朗日型余项可以写成

$$
R_n(x) = \frac{f^{(n+1)} (a + \theta (x - a))}{(n+1)!} (x - a)^{n+1}.
$$


###### 带积分余项的泰勒公式
>利用分部积分法导出泰勒公式余项的一种表示——余项的积分表示

**定理：带积分余项的泰勒公式**

$$
R_n(x) = \frac{1}{n!} \int_{a}^x f^{(n+1)}(t) (x-t)^n dt 
$$

称上式为积分形式的余项.

*（证明通过对 牛顿-莱布尼茨公式做分部积分 $n$ 次得到带积分余项的泰勒公式）.*


**柯西型余项**

在上述定理中，对余项用推广的积分第一中值定理可得

$$
R_n(x) = \frac{f^{(n+1)}(\xi)}{n!} (x-\xi)^n (x-a)
$$

这种形式的余项称为**柯西型余项**. 

*注：拉格朗日余项也可以由积分余项通过t推广的积分第一中值定理得到.*


### 函数的凸性与拐点

##### 凸函数

**定义：凸函数**
设 $f$ 为定义在区间 $I$ 上的函数，若对 $I$ 上的任意两点 $x_1, x_2$ 和任意实数 $\lambda \in (0,1)$，总有

$$
f(\lambda x_1 + (1 - \lambda)x_2) \leq \lambda f(x_1) + (1 - \lambda)f(x_2),
$$

则称 $f$ 为 $I$ 上的**凸函数**. 反之，若总有

$$
f(\lambda x_1 + (1 - \lambda)x_2) \geq \lambda f(x_1) + (1 - \lambda)f(x_2),
$$

则称 $f$ 为 $I$ 上的**凹函数**.

**注：**

1. 若上述两不等式改为严格不等式，则相应的函数称为**严格凸函数**和**严格凹函数**；
2. 容易证明，若 $-f$ 为区间 $I$ 上的凸函数，则 $f$ 为区间 $I$ 上的凹函数. 因此，只需讨论凸函数的性质即可.
3. 该定义的几何意义即为：连接函数上两点间的线段（割线），比较函数与割线的上下关系.


**定理：凸函数定义的等价陈述方式**

设函数 $f$ 在区间 $I$ 上有定义，则以下各项陈述互相等价：

1. $f$ 在区间 $I$ 是（下）凸函数；
2. 对任何 $x_1, x_2 \in I, x_1 < x_2$，和介于 $x_1$ 与 $x_2$ 之间的任何 $x$，都有

	$$
	f(x) \leq \frac{x_2 - x}{x_2 - x_1} f(x_1) + \frac{x - x_1}{x_2 - x_1} f(x_2);
	$$

	*注：不等式右边即为割线方程.*

3. 对任何 $x_1, x_2 \in I, x_1 < x_2$，和介于 $x_1$ 与 $x_2$ 之间的任何 $x$，都有

	$$
	\frac{f(x) - f(x_1)}{x - x_1} \leq \frac{f(x_2) - f(x_1)}{x_2 - x_1} \leq \frac{f(x_2) - f(x)}{x_2 - x};
	$$

	*注：几何意义显然.*

4. 对任何 $x_1, x_2 \in I, x_1 < x_2$，和介于 $x_1$ 与 $x_2$ 之间的任何 $x$，都有

	$$
	\frac{f(x) - f(x_1)}{x - x_1} \leq \frac{f(x_2) - f(x)}{x_2 - x_1}.
	$$

*注：如果把 1 中的 “（下）凸” 改成 “严格（下）凸”，并把 2、3、4 和 5 中的各个不等号改成严格的不等号，那么修改后的各条陈述也仍然是互相等价的.*


**定理：Jensen 不等式**
若 $f$ 为 $[a,b]$ 上的凸函数，则对任意 $x_i \in [a,b], \lambda_i > 0 \ (i=1,2,\cdots,n), \sum_{i=1}^n \lambda_i = 1$，有

$$
f\left(\sum_{i=1}^n \lambda_i x_i\right) \leq \sum_{i=1}^n \lambda_i f(x_i).
$$

*注：如 $f(x)$ 在 $[a,b]$ 上严格凸，则上述不等式可为严格不等式，除非 $x_1=x_2=\cdots=x_n$.*


##### 利用导数判别凹凸与拐点

**定理：利用一阶导判定函数凹凸性**

设函数 $f$ 在区间 $I$ 连续，在 $I^0$ 可导。则 $f$ 在区间 $I$ 为凸函数（严格凸函数）的充要条件是 $f'$ 在 $I^0$ 单调上升（严格单调上升）.


**定理：利用二阶导判定函数凹凸性**

设函数 $f$ 在区间 $I$ 连续，在 $I^0$ 二阶可导，则 $f$ 在区间 $I$ 为凸函数的充要条件是：

$$
f''(x) \geq 0, \quad \forall x \in I^0.
$$

而 $f$ 在区间 $I$ 为严格凸函数的充要条件是：

$$
f''(x) \geq 0, \quad \forall x \in I^0,
$$

并且 $f''$ 不在 $I^0$ 的任何开子区间上恒等于0.

*注：关于二次可导函数为凹函数的条件，也有相应的结果.*


**定义：拐点**

设函数 $f$ 在 $U(x_0, \eta)$ 上有定义，并且在 $x_0$ 的左右两侧有不同的凹凸性，则称点 $(x_0,f(x_0))$ 为 $f$ 的一个拐点.

*注：华师大《数学分析》第六版教材定义该点为拐点，北大《数学分析新讲》（重排本）上定义 $x_0$ 为拐点.*


- 对于可导函数 $f$ 来说，拐点就是 $f'$ 改变单调性的地方（因而也就必须是 $f'$ 的极值点）.


**定理：拐点的必要条件**

设函数 $f$ 在 $U(x_0, \eta)$ 上有定义，在 $x_0$ 处有二阶导数。如果 $x_0$ 是 $f$ 的一个拐点，那么必有

$$
f''(x_0) = 0.
$$


**定理：拐点的第一充分条件**

设函数 $f$ 在 $U(x_0, \eta)$ 上有二阶导数，$f''(x_0) = 0$。如果 $f''(x)$ 经过 $x_0$ 时改变符号，那么 $x_0$ 点是函数 $f$ 的拐点.

**定理：拐点的第二充分条件**

设函数 $f$ 在 $x_0$ 处有三阶导数. 如果

$$
f''(x_0) = 0, \quad f'''(x_0) \neq 0,
$$

那么 $x_0$ 点是函数 $f$ 的拐点.

*注：仿照极值的第三充分条件，还可陈述关于拐点的第三充分条件.*


### 函数图像

##### 曲线的渐近线

1. 曲线 $y = f(x)$ 有竖直渐近线 $x = a$ 的充要条件是函数 $f(x)$ 在 $a$ 点有无穷间断，也就是

	$$
	\lim_{x \to a} f(x) = \infty\quad(a \in \mathbb{R})
	$$

2. 曲线 $y = f(x)$ 有斜渐近线 $y = kx + b$ 的充要条件是

	$$
	\lim_{x \to +\infty} \frac{f(x)}{x} = k,
	$$

	$$
	\lim_{x \to +\infty} (f(x) - kx) = b.
	$$

	这里所说的“斜渐近线”，包括 $k = 0$ 的情形，即包括了水平渐近线。容易看出：曲线 $y = f(x)$ 有水平渐近线 $y = b$ 的充要条件是

	$$
	\lim_{x \to +\infty} f(x) = b.
	$$

##### 作函数图像

一般步骤：

1. 求定义域；
2. 求奇偶性、周期性；
3. 求渐近线；
4. 求 $f'(x)=0$ 的根和各根间的符号，判别升降与极值情况；
5. 求 $f''(x)=0$ 的根和各根间的符号，判别凹凸与拐点情况；
6. 标出代表性的点：与坐标轴交点、不连续点、不可导点等.
7. 作图

- 域、性、线、根、点